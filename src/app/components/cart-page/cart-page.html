<h2>ðŸ›’ ×¡×œ ×”×§× ×™×•×ª</h2>

<ng-container *ngIf="(cart?.length ?? 0) > 0; else empty">
  <ul class="cart-list">
    <li *ngFor="let ci of (cart ?? []); let i = index; trackBy: track" class="cart-item">
      <img [src]="ci.product.imageUrl" [alt]="ci.product.name" width="60" />

      <div class="details">
        <div class="name">{{ ci.product.name }}</div>
        <div class="unit">×ž×—×™×¨ ×œ×™×—×™×“×”: {{ ci.product.price | number:'1.2-2' }}$</div>

        <!-- ×¢×¨×™×›×ª ×›×ž×•×ª ×‘×ª×•×š ×”×¡×œ -->
        <div class="qty-controls">
          <button type="button" (click)="decrease(i)">âˆ’</button>
          <input
            type="number"
            [value]="ci.qty"
            min="1"
            (input)="setQty(i, $any($event.target).value)"
          />
          <button type="button" (click)="increase(i)">+</button>
        </div>

        <div class="line-total">
          ×¡×”×´×› ×©×•×¨×”: {{ (ci.product.price * ci.qty) | number:'1.2-2' }}$
        </div>
      </div>

      <button type="button" class="remove" (click)="removeItem(i)">×”×¡×¨</button>
    </li>
  </ul>

  <h3>×¡×”×´×›: {{ totalPrice | number:'1.2-2' }}$</h3>

  <div class="actions">
    <!-- ×—×¡×™×ž×ª ×©×œ×™×—×ª ×”×–×ž× ×” ×× ×œ× ×ž×—×•×‘×¨/×ª -->
  <button type="button" (click)="clearCart()">× ×§×” ×¡×œ</button>
    <button
      type="button"
      class="submit"
      (click)="submitOrder()"
      [disabled]="!auth.isLoggedIn || !cart.length"
      [title]="auth.isLoggedIn ? '' : '×™×© ×œ×”×™×›× ×¡ ×œ×ž×¢×¨×›×ª ×œ×¤× ×™ ×©×œ×™×—×ª ×”×–×ž× ×”'">
      ×©×œ×™×—×ª ×”×”×–×ž× ×”
    </button>
  </div>

  <!-- ×”×•×“×¢×ª ×¢×–×¨ ×›×©×œ× ×ž×—×•×‘×¨×™× -->
  <p class="note" *ngIf="!auth.isLoggedIn">
    ×™×© ×œ×”×™×›× ×¡ ×œ×ž×¢×¨×›×ª ×‘×“×£ ×”×‘×™×ª ×›×“×™ ×œ×‘×¦×¢ ×”×–×ž× ×”.
  </p>
</ng-container>

<ng-template #empty>
  <p>×”×¡×œ ×¨×™×§</p>
</ng-template>

<!-- ×¤×•×¤××¤ ×”×¦×œ×—×” -->
<div class="overlay" *ngIf="showSuccess" (click)="closePopup()">
  <div class="popup" (click)="$event.stopPropagation()">
    <h3>âœ… ×”×”×–×ž× ×” × ×©×œ×—×” ×‘×”×¦×œ×—×”</h3>
    <p *ngIf="orderId">×ž×¡' ×”×–×ž× ×”: {{ orderId }}</p>
    <button type="button" (click)="closePopup()">×¡×’×™×¨×”</button>
  </div>
</div>
